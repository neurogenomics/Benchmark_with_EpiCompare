---
title: "EpiCompare_ENCODE_correlation"
output:
  html_document:
    df_print: paged
---

### Update EppiCompare

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, root.dir=here::here())
knitr::opts_knit$set(echo = TRUE, root.dir=here::here())

#### GitHub ####
if(!require("EpiCompare")) remotes::install_github("neurogenomics/EpiCompare")
```


### Load the EpiCompare package
```{r}
library(EpiCompare)
```

### Load ENCODE files 
#### Notation: 
#### PTM name;
#### EN 3/4 for ENCODE 3 or 4 (might be a factor); G for genome build
#### E for experiments 
#### IR for isogenic replicates (pseudo if pseudoreplicates)


### A549 H3K4me3
```{r}
ENCODE_peak1 <- ChIPseeker::readPeakFile("/Users/apple/Downloads/called_peaks/H3K27me3_500_dedup_top001.peaks.stringent.bed", as = "GRanges")
ENCODE_peak2 <- ChIPseeker::readPeakFile("/Users/apple/Downloads/called_peaks/H3K9me1_200_dedup_control.peaks.stringent.bed", as = "GRanges")


peakfiles <- list(ENCODE_peak1,ENCODE_peak2)
names(peakfiles) <- c("ENCODE_peak1","ENCODE_peak2")

gc()
```

```{r}
data(hg38_blacklist)
EpiCompare(peakfiles = peakfiles,
                       picard_files = list(),
                       blacklist = hg38_blacklist,
                       genome_build = list(peakfiles="hg38",
                                           reference="hg38",
                                           blacklist="hg38"),
                       genome_build_output = "hg38",
                       reference = ENCODE_peak1,
                       upset_plot = TRUE,
                       stat_plot = TRUE,
                       chromHMM_plot = TRUE,
                       chromHMM_annotation = "K562",
                       chipseeker_plot = TRUE,
                       enrichment_plot = TRUE,
                       tss_plot = TRUE,
                       save_output = TRUE,
                       precision_recall_plot = TRUE,
                       output_dir = "/Users/apple/Downloads/test")
```






